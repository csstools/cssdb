---
import { trimCaniuseFeatures } from '../../utils/trim-caniuse-features.js';
const { feature, title } = Astro.props;
const caniuse = trimCaniuseFeatures(feature);

const link = `https://caniuse.com/${feature.caniuse ? `${feature.caniuse}` : ''}`;
const browsers = {
	'ios_saf': 'iOS Safari',
	'op_mob': 'Opera Mobile',
	'and_uc': 'UC Mobile for Android',
	'and_chr': 'Chrome for Android',
	'and_ff': 'Firefox for Android',
	'and_qq': 'QQ Browserr',
};
---
{ caniuse && caniuse.stats && (
<a
		class="cssdb-feature-caniuse"
		href={link}
		target="_blank"
		rel="noreferrer"
		aria-label={`can i use browser support for ${title}`}
>
	{Object.keys(caniuse.stats).map(id => (
		<span class={`cssdb-browser cssdb-browser--${id}`}>
			{Object.keys(caniuse.stats[id]).filter(
				version => caniuse.stats[id][version].indexOf('y') === 0
			).slice(0, 1).map(
				version => version.replace(/(\.0)?(-.+)?$/, '')
			).map(
				version => (
					 <span class="sr-only">Supported on {browsers[id] || id} since version </span>
					 <span class="cssdb-browser-version">{version}</span>
				)
			)}
		</span>
	))}
</a>
) }
